"use strict";$(document).ready(function(){$(document).on("click","#btn-create-post",function(e){e.preventDefault(),createPostCreateModal()}),$(document).on("submit","#"+Constants.CREATE_POST_FORM_ID,function(e){e.preventDefault();var t=$(this),a=t.attr("action"),s=t.attr("method").trim(),r=t.serializeArray(),n=r.asMap("name","value");n.category_id=t.data("category-id"),$.ajax({url:a,method:s,data:JSON.stringify(n),success:function(e){var t=e.message;generateNotification(t,"success",!0,2500),hideModalsAndRefreshPosts()},error:function(e){}})}),$(document).on("submit","#"+Constants.EDIT_POST_FORM_ID,function(e){e.preventDefault();var t=$(this),a=t.attr("action"),s=t.attr("method").trim(),r=t.serializeArray().asMap("name","value");$.ajax({url:a,method:s,data:JSON.stringify(r),success:function(e){var t=e.message;generateNotification(t,"success",!0,2500),hideModalsAndRefreshPosts()},error:function(e){}})})}),$(document).ready(function(){$(document).on("click",".btn-delete-request",function(e){e.preventDefault();var t=$(this),a=t.data("request-id");bootbox.confirm({title:Laravel.strings.delete_request_confirm_modal.title,message:Laravel.strings.delete_request_confirm_modal.message,buttons:{cancel:{label:'<i class="fa fa-times"></i> '+Laravel.strings.delete_request_confirm_modal.btn.cancel},confirm:{label:'<i class="fa fa-check"></i> '+Laravel.strings.delete_request_confirm_modal.btn.confirm,className:"btn-danger"}},callback:function(e){if(!0===e){var t=renderUrl(a,Laravel.apis.requests.delete);$.ajax({url:t,method:"DELETE",success:function(e){var t=e.message;generateNotification(t,"success",!0,2500),$(".modal").modal("hide")},error:function(e){}})}}})}),$(document).on("click",".btn-show-user-requests",function(e){e.preventDefault();var t=$(this).data("user-id"),a=renderUrl(t,Laravel.apis.users.getRequests);$.ajax({url:a,method:"GET",success:function(e){var t=e,a=Constants.MODALS_CONTAINER_ID,s=Constants.MODAL_TEMPLATE_ID,r=Constants.USER_REQUESTS_MODAL_ID,n={modal:{id:r,class:"auto-destroy",title:Laravel.strings.user_requests_modal.modal.title+" "+t.name,body:'<table id="user-requests-data-table" class="table table-striped table-bordered" cellspacing="0" width="100%"></table>',footer:""}};_.renderTemplate(s,n,a,!0);var i=[];$.each(t.requests,function(e,t){var a="<dl>";$.each(t.properties,function(e,t){a+="<dt>"+t.title+"</dt>";var s=t.value;if("ALL"===s)s=Laravel.strings.user_requests.types.ALL;else if("NUMBER"===t.value_type&&(s=parseInt(s).toLocaleString("en"),t.extra_settings.currency)){var r=t.extra_settings.currency,n=getCurrencySymbolHtmlCode(r);n&&(s=n+" "+s)}a+="<dd>"+s+"</dd>"}),a+="</dl>",i.push([t.id,t.category.name,a])}),$("#user-requests-data-table").DataTable({data:i,bFilter:!1,bLengthChange:!1,pageLength:15,columns:[{title:"id"},{title:Laravel.strings.user_requests_modal.table_columns_titles.category},{title:Laravel.strings.user_requests_modal.table_columns_titles.properties},{data:null,defaultContent:""}],columnDefs:[{targets:[0,1,2,3],orderable:!1},{sClass:"center",aTargets:[1,3]},{targets:0,visible:!1},{targets:-1,render:function(e,t,a){return'<a href="javascript:void(0);" class="btn btn-warning btn-edit-request" data-request-id="'+e[0]+'"><i class="fa fa-pencil" aria-hidden="true"></i></a> <a href="javascript:void(0);" class="btn btn-danger btn-delete-request" data-request-id="'+e[0]+'"><i class="fa fa-trash" aria-hidden="true"></i></a>'}}],language:{url:"ar"===Laravel.locale?null:Laravel.assets.dataTables.lang.default,sProcessing:"جارٍ التحميل...",sLengthMenu:"أظهر _MENU_ مدخلات",sZeroRecords:"لا يوجد متابعات",sInfo:"إظهار _START_ إلى _END_ من أصل _TOTAL_ مدخل",sInfoEmpty:"لا يوجد متابعات",sInfoFiltered:"(منتقاة من مجموع _MAX_ مُدخل)",sInfoPostFix:"",sSearch:"ابحث:",sUrl:"",oPaginate:{sFirst:"الأول",sPrevious:"السابق",sNext:"التالي",sLast:"الأخير"}}}),$("#"+r).modal("show")},error:function(e){}})})});